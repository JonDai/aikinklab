# ZAP Security Scan Rules Configuration
# Format: rule_id	action	parameter	value

# Ignore false positives
10021	IGNORE		# X-Content-Type-Options Header Missing - handled by Next.js
10020	IGNORE		# X-Frame-Options Header Missing - configured in next.config.js
10016	IGNORE		# Web Browser XSS Protection Not Enabled - modern browsers

# Information disclosure rules
10037	WARN		# Server Leaks Information via "X-Powered-By" HTTP Response Header Field(s)
10038	WARN		# Content Security Policy (CSP) Header Not Set
10040	WARN		# Secure Pages Include Mixed Content

# Authentication rules  
10055	FAIL		# CSP: Wildcard Directive
10056	FAIL		# CSP: unsafe-inline
10057	FAIL		# CSP: unsafe-eval

# Session management
10019	FAIL		# HTTP Only Site Uses Cookies Without Secure Flag
10022	FAIL		# Information Disclosure - Sensitive Information in URL
10023	FAIL		# Information Disclosure - Sensitive Information in HTTP Referrer Header

# Input validation
40012	FAIL		# Cross Site Scripting (Reflected)
40013	FAIL		# Session Fixation
40014	FAIL		# Cross Site Scripting (Persistent)
40016	FAIL		# Cross Site Scripting (DOM Based)
40017	FAIL		# Source Code Disclosure - CVE-2012-1823
40018	FAIL		# SQL Injection
40019	FAIL		# SQL Injection - MySQL
40020	FAIL		# SQL Injection - Hypersonic SQL
40021	FAIL		# SQL Injection - Oracle
40022	FAIL		# SQL Injection - PostgreSQL
40023	FAIL		# Possible Username Enumeration
40024	FAIL		# SQL Injection - SQLite
40025	FAIL		# Proxy Disclosure
40026	FAIL		# Cross Site Scripting (DOM Based) - Mozilla Specific
40027	FAIL		# SQL Injection - MsSQL
40028	FAIL		# LDAP Injection
40029	FAIL		# CRLF Injection

# Path traversal
40031	FAIL		# Backup File Disclosure
40032	FAIL		# .htaccess Information Leak
40033	FAIL		# Path Traversal
40034	FAIL		# .DS_Store Information Leak

# Modern security headers
10063	WARN		# Permissions Policy Header Not Set
10064	WARN		# Charset Mismatch
10065	WARN		# HTTPS Content Available via HTTP

# Skip common false positives for static assets
90001	IGNORE	url	.*\.(css|js|png|jpg|jpeg|gif|ico|woff|woff2|ttf|eot)$

# Skip health check endpoints from certain tests
40012	IGNORE	url	.*/api/health.*
40018	IGNORE	url	.*/api/health.*

# Configure scan intensity
SCAN_INTENSITY	MEDIUM

# Custom headers to include in requests
HEADER	User-Agent	ZAP Security Scan - AIKinkLab
HEADER	Accept	application/json,text/html,application/xhtml+xml

# Exclude logout/session endpoints from active scanning
EXCLUDE_URL_PATTERN	.*/logout.*
EXCLUDE_URL_PATTERN	.*/session.*